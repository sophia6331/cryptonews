(function(e){"use strict";if(typeof define==="function"&&define.amd){define(["jquery"],e)}else if(typeof exports==="object"&&typeof require==="function"){e(require("jquery"))}else{e(jQuery)}})(function(e){"use strict";var t=function(){return{escapeRegExChars:function(e){return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")},createNode:function(e){var t=document.createElement("div");t.className=e;t.style.display="none";return t}}}(),n={ESC:27,TAB:9,RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40};function s(t,n){var s=e.noop,i=this,o={ajaxSettings:{},autoSelectFirst:false,appendTo:document.body,serviceUrl:null,lookup:null,onSelect:null,onMouseOver:null,onMouseLeave:null,width:"100%",minChars:1,maxHeight:1e3,deferRequestBy:0,params:{},delimiter:null,zIndex:9999,type:"GET",noCache:false,is_rtl:false,onSearchStart:s,onSearchComplete:s,onSearchError:s,preserveInput:false,wrapperaClass:"search-wrapp",containerClass:"search-suggestions-wrapp",preloaderClass:"search-preloader",closeTrigger:"search-close",tabDisabled:false,dataType:"text",currentRequest:null,triggerSelectOnValidInput:true,preventBadQueries:true,lookupFilter:function(e,t,n){return e.value.toLowerCase().indexOf(n)!==-1},paramName:"query",transformResult:function(e){return typeof e==="string"?JSON.parse(e):e},showNoSuggestionNotice:false,noSuggestionNotice:"No results",orientation:"bottom"};i.element=t;i.el=e(t);i.suggestions=[];i.badQueries=[];i.selectedIndex=-1;i.currentValue=i.element.value;i.intervalId=0;i.cachedResponse={};i.detailsRequestsSent=[];i.onChangeInterval=null;i.onChange=null;i.isLocal=false;i.suggestionsContainer=null;i.detailsContainer=null;i.noSuggestionsContainer=null;i.options=e.extend({},o,n);i.classes={selected:"search-suggestion-selected",suggestion:"search-suggestion"};i.hint=null;i.hintValue="";i.selection=null;i.initialize();i.setOptions(n)}s.utils=t;e.Autocomplete=s;s.prototype={killerFn:null,initialize:function(){var t=this,n="."+t.classes.suggestion,i=t.classes.selected,o=t.options,r,a="."+o.closeTrigger;t.killerFn=function(n){if(e(n.target).closest("."+t.options.containerClass).length===0){t.killSuggestions();t.disableKillerFn()}};t.suggestionsContainer=s.utils.createNode(o.containerClass);r=e(t.suggestionsContainer);r.appendTo(t.el.closest("."+o.wrapperaClass));if(o.width!=="auto"){r.width(o.width)}r.on("mouseover.autocomplete",n,function(){t.onMouseOver(e(this).data("index"));t.activate(e(this).data("index"))});r.on("mouseout.autocomplete",function(){});e(document).on("click.autocomplete",a,function(n){t.killerFn(n);t.clear(n);e(this).removeClass(o.closeTrigger);t.el.val("").focus()});r.on("click.autocomplete",n,function(){t.select(e(this).data("index"));return false});t.el.on("keydown.autocomplete",function(e){t.onKeyPress(e)});t.el.on("keyup.autocomplete",function(e){t.onKeyUp(e)});t.el.on("change.autocomplete",function(e){t.onKeyUp(e)});t.el.on("input.autocomplete",function(e){t.onKeyUp(e)})},onFocus:function(){var e=this;if(e.el.val().length>=e.options.minChars){e.onValueChange()}},onBlur:function(){this.enableKillerFn()},abortAjax:function(){var e=this;if(e.currentRequest){e.currentRequest.abort();e.currentRequest=null}},setOptions:function(t){var n=this,s=n.options;e.extend(s,t);n.isLocal=Array.isArray(s.lookup);if(n.isLocal){s.lookup=n.verifySuggestionsFormat(s.lookup)}s.orientation=n.validateOrientation(s.orientation,"bottom");n.options.onSearchComplete=function(){n.preloader("hide",e("."+s.preloaderClass),s.closeTrigger)}},clearCache:function(){this.cachedResponse={};this.badQueries=[]},clear:function(){this.clearCache();this.currentValue="";this.suggestions=[]},disable:function(){var e=this;e.disabled=true;clearInterval(e.onChangeInterval);e.abortAjax()},enable:function(){this.disabled=false},enableKillerFn:function(){var t=this;e(document).on("click.autocomplete",t.killerFn)},disableKillerFn:function(){var t=this;e(document).off("click.autocomplete",t.killerFn)},killSuggestions:function(){var t=this,n=e(t.suggestionsContainer).parent();t.stopKillSuggestions();t.intervalId=window.setInterval(function(){if(t.visible){if(!t.options.preserveInput){t.el.val(t.currentValue)}t.hide()}t.stopKillSuggestions()},50)},stopKillSuggestions:function(){window.clearInterval(this.intervalId)},isCursorAtEnd:function(){var e=this,t=e.el.val().length,n=e.element.selectionStart,s;if(typeof n==="number"){return n===t}if(document.selection){s=document.selection.createRange();s.moveStart("character",-t);return t===s.text.length}return true},onKeyPress:function(e){var t=this;if(!t.disabled&&!t.visible&&e.which===n.DOWN&&t.currentValue){t.suggest();return}if(t.disabled||!t.visible){return}switch(e.which){case n.ESC:t.el.val(t.currentValue);t.hide();break;case n.RIGHT:if(t.hint&&t.options.onHint&&t.isCursorAtEnd()){t.selectHint();break}return;case n.TAB:if(t.hint&&t.options.onHint){t.selectHint();return}if(t.selectedIndex===-1){t.hide();return}t.select(t.selectedIndex);if(t.options.tabDisabled===false){return}break;case n.RETURN:if(t.selectedIndex===-1){t.hide();return}t.select(t.selectedIndex);break;case n.UP:t.moveUp();break;case n.DOWN:t.moveDown();break;default:return}e.stopImmediatePropagation();e.preventDefault()},onKeyUp:function(e){var t=this;if(t.disabled){return}switch(e.which){case n.UP:case n.DOWN:return}clearInterval(t.onChangeInterval);if(t.currentValue!==t.el.val()){t.findBestHint();if(t.options.deferRequestBy>0){t.onChangeInterval=setInterval(function(){t.onValueChange()},t.options.deferRequestBy)}else{t.onValueChange()}}},onValueChange:function(){var t=this,n=t.options,s=t.el.val(),i=t.getQuery(s);if(t.selection&&t.currentValue!==i){t.selection=null;(n.onInvalidateSelection||e.noop).call(t.element)}clearInterval(t.onChangeInterval);t.currentValue=s;t.selectedIndex=-1;if(n.triggerSelectOnValidInput&&t.isExactMatch(i)){t.select(0);return}if(i.length<n.minChars){e("."+t.options.closeTrigger).removeClass(t.options.closeTrigger);t.hide()}else{t.getSuggestions(i)}},isExactMatch:function(e){var t=this.suggestions;return t.length===1&&t[0].value.toLowerCase()===e.toLowerCase()},getQuery:function(t){var n=this.options.delimiter,s;if(!n){return t}s=t.split(n);return e.trim(s[s.length-1])},getSuggestionsLocal:function(t){var n=this,s=n.options,i=t.toLowerCase(),o=s.lookupFilter,r=parseInt(s.lookupLimit,10),a;a={suggestions:e.grep(s.lookup,function(e){return o(e,t,i)})};if(r&&a.suggestions.length>r){a.suggestions=a.suggestions.slice(0,r)}return a},getSuggestions:function(t){var n,s=this,i=e(s.suggestionsContainer),o=s.options,r=o.serviceUrl,a,l,u;o.params[o.paramName]=t;a=o.ignoreParams?null:o.params;s.preloader("show",e("."+o.preloaderClass),"search-inner-preloader",i);if(o.onSearchStart.call(s.element,o.params)===false){return}if(e.isFunction(o.lookup)){o.lookup(t,function(e){s.suggestions=e.suggestions;s.suggest();o.onSearchComplete.call(s.element,t,e.suggestions)});return}if(s.isLocal){n=s.getSuggestionsLocal(t)}else{if(e.isFunction(r)){r=r.call(s.element,t)}l=r+"?"+e.param(a||{});n=s.cachedResponse[l]}if(n&&Array.isArray(n.suggestions)){s.suggestions=n.suggestions;s.suggest();o.onSearchComplete.call(s.element,t,n.suggestions)}else if(!s.isBadQuery(t)){s.abortAjax();u={url:r,data:a,type:o.type,dataType:o.dataType};e.extend(u,o.ajaxSettings);s.currentRequest=e.ajax(u).done(function(e){var n;s.currentRequest=null;n=o.transformResult(e,t);if(typeof n.suggestions!=="undefined"){s.processResponse(n,t,l)}o.onSearchComplete.call(s.element,t,n.suggestions)}).fail(function(e,n,i){o.onSearchError.call(s.element,t,e,n,i)})}else{o.onSearchComplete.call(s.element,t,[])}},isBadQuery:function(e){if(!this.options.preventBadQueries){return false}var t=this.badQueries,n=t.length;while(n--){if(e.indexOf(t[n])===0){return true}}return false},hide:function(){var t=this,n=e(t.suggestionsContainer),s=e(t.suggestionsContainer).parent();if(e.isFunction(t.options.onHide)&&t.visible){t.options.onHide.call(t.element,n)}t.visible=false;t.selectedIndex=-1;clearInterval(t.onChangeInterval);e(t.suggestionsContainer).hide();e(t.detailsContainer).hide();s.removeClass("search-open");t.signalHint(null)},suggest:function(){if(this.suggestions==""){if(this.options.showNoSuggestionNotice){this.noSuggestions()}else{this.hide()}return}var t=this,n=t.options,s=n.groupBy,i=n.formatResult,o=t.getQuery(t.currentValue),r=t.classes.suggestion,a=t.classes.selected,l=e(t.suggestionsContainer),u=e(t.noSuggestionsContainer),c=n.beforeRender,g,d=function(e,t){var n=e.data[s];if(g===n){return""}g=n;return'<div class="autocomplete-group"><strong>'+g+"</strong></div>"};if(n.triggerSelectOnValidInput&&t.isExactMatch(o)){t.select(0);return}this.adjustContainerWidth();u.detach();l.html(t.suggestions);if(e.isFunction(c)){c.call(t.element,l,t.suggestions)}l.show();l.parent().addClass("search-open");if(n.autoSelectFirst){t.selectedIndex=0;l.scrollTop(0);l.children("."+r).first().addClass(a)}t.visible=true;t.findBestHint()},noSuggestions:function(){},adjustContainerWidth:function(){var t=this,n=t.options,s,i=e(t.suggestionsContainer).parent(),o=e(t.suggestionsContainer),r=550;if(n.width==="auto"){s=t.el.outerWidth();o.css("width",s+"px")}},findBestHint:function(){var e=this,t=e.el.val().toLowerCase(),n=null;if(!t){return}e.signalHint(n)},signalHint:function(t){var n="",s=this;if(t){n=s.currentValue+t.value.substr(s.currentValue.length)}if(s.hintValue!==n){s.hintValue=n;s.hint=t;(this.options.onHint||e.noop)(n)}},preloader:function(t,n,s,i){var o,r="search-preloader-wrapp",a=s==null?r:r+" "+s;if(search.show_preloader!=1||n.length==0){return}if(t==="hide"){e(r).remove();n.html("");if(!e(".search-suggestions-wrapp .products")[0]){}}if(t==="show"){i.html("");n.html('<div class="'+a+'"></div>')}},validateOrientation:function(t,n){t=e.trim(t||"").toLowerCase();if(e.inArray(t,["auto","bottom","top"])===-1){t=n}return t},processResponse:function(e,t,n){var s=this,i=s.options;if(!i.noCache){s.cachedResponse[n]=e;if(i.preventBadQueries&&!e.suggestions.length){s.badQueries.push(t)}}if(t!==s.getQuery(s.currentValue)){return}s.suggestions=e.suggestions;s.suggest()},activate:function(t){var n=this,s,i=n.classes.selected,o=e(n.suggestionsContainer),r=o.find("."+n.classes.suggestion);o.find("."+i).removeClass(i);n.selectedIndex=t;if(n.selectedIndex!==-1&&r.length>n.selectedIndex){s=r.get(n.selectedIndex);e(s).addClass(i);return s}return null},selectHint:function(){var t=this,n=e.inArray(t.hint,t.suggestions);t.select(n)},select:function(e){var t=this;t.hide();t.onSelect(e);t.disableKillerFn()},moveUp:function(){var t=this;if(t.selectedIndex===-1){return}if(t.selectedIndex===0){e(t.suggestionsContainer).children().first().removeClass(t.classes.selected);t.selectedIndex=-1;t.el.val(t.currentValue);t.findBestHint();return}t.adjustScroll(t.selectedIndex-1)},moveDown:function(){var e=this;if(e.selectedIndex===e.suggestions.length-1){return}e.adjustScroll(e.selectedIndex+1)},adjustScroll:function(t){var n=this,s=n.activate(t);if(!s){return}var i,o,r,a=e(s).outerHeight();i=s.offsetTop;o=e(n.suggestionsContainer).scrollTop();r=o+n.options.maxHeight-a;if(i<o){e(n.suggestionsContainer).scrollTop(i)}else if(i>r){e(n.suggestionsContainer).scrollTop(i-n.options.maxHeight+a)}if(!n.options.preserveInput){n.el.val(n.getValue(n.suggestions[t].value))}n.signalHint(null)},onSelect:function(t){var n=this,s=n.options.onSelect,i=n.suggestions[t];n.currentValue=n.getValue(i.value);if(n.currentValue!==n.el.val()&&!n.options.preserveInput){n.el.val(n.currentValue)}if(i.id!=-1){window.location.href=i.url}n.signalHint(null);n.suggestions=[];n.selection=i;if(e.isFunction(s)){s.call(n.element,i)}},onMouseOver:function(t){var n=this,s=n.options.onMouseOver,i=n.suggestions[t];if(e.isFunction(s)){s.call(n.element,i)}},onMouseLeave:function(t){var n=this,s=n.options.onMouseLeave,i=n.suggestions[t];if(e.isFunction(s)){s.call(n.element,i)}},getValue:function(e){var t=this,n=t.options.delimiter,s,i;if(!n){return e}s=t.currentValue;i=s.split(n);if(i.length===1){return e}return s.substr(0,s.length-i[i.length-1].length)+e},dispose:function(){var t=this;t.el.off(".autocomplete").removeData("autocomplete");t.disableKillerFn();e(t.suggestionsContainer).remove()}};e.fn.dgwtWcasAutocomplete=function(t,n){var i="autocomplete";if(!arguments.length){return this.first().data(i)}return this.each(function(){var o=e(this),r=o.data(i);if(typeof t==="string"){if(r&&typeof r[t]==="function"){r[t](n)}}else{if(r&&r.dispose){r.dispose()}r=new s(this,t);o.data(i,r)}})};(function(){e(function(){"use strict";e(".search-input").dgwtWcasAutocomplete({minChars:3,autoSelectFirst:false,triggerSelectOnValidInput:false,serviceUrl:search.ajax_search_endpoint,paramName:"search_keyword"})})})()});